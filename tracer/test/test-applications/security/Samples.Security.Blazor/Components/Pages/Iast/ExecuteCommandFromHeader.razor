@page "/Iast/ExecuteCommandFromHeader/"
@using Datadog.Trace.Annotations.Controllers
@inject IHttpContextAccessor HttpContextAccessor;

<h3>Execute Command From Header</h3>

<p>@_message</p>

@code {
    private string? _message;

    protected override void OnInitialized()
    {
        var file = HttpContextAccessor.HttpContext?.Request.Headers["file"];
        var argumentLine = HttpContextAccessor.HttpContext?.Request.Headers["argumentLine"];
        _message = IastController.ExecuteCommandInternal(file, argumentLine);
    }
}