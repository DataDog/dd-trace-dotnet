// <copyright file="VulnerabilityTypeName.cs" company="Datadog">
// Unless explicitly stated otherwise all files in this repository are licensed under the Apache 2 License.
// This product includes software developed at Datadog (https://www.datadoghq.com/). Copyright 2017 Datadog, Inc.
// </copyright>

#nullable enable
using System.ComponentModel;

namespace Datadog.Trace.Iast;

/// <summary>
/// Extension functions for VulnerabilityType enum
/// </summary>
internal static class VulnerabilityTypeName
{
    /// <summary> Undefined vulnerability </summary>
    public const string None = "NONE";

    /// <summary> WEAK_CIPHER vulnerability </summary>
    public const string WeakCipher = "WEAK_CIPHER";

    /// <summary> WEAK_HASH vulnerability </summary>
    public const string WeakHash = "WEAK_HASH";

    /// <summary> SQL_INJECTION vulnerability </summary>
    public const string SqlInjection = "SQL_INJECTION";

    /// <summary> COMMAND_INJECTION vulnerability </summary>
    public const string CommandInjection = "COMMAND_INJECTION";

    /// <summary> PATH_TRAVERSAL vulnerability </summary>
    public const string PathTraversal = "PATH_TRAVERSAL";

    /// <summary> LDAP_INJECTION vulnerability </summary>
    public const string LdapInjection = "LDAP_INJECTION";

    /// <summary> SSRF vulnerability </summary>
    public const string Ssrf = "SSRF";

    /// <summary> UNVALIDATED_REDIRECT vulnerability </summary>
    public const string UnvalidatedRedirect = "UNVALIDATED_REDIRECT";

    /// <summary> INSECURE_COOKIE vulnerability </summary>
    public const string InsecureCookie = "INSECURE_COOKIE";

    /// <summary> NO_HTTPONLY_COOKIE vulnerability </summary>
    public const string NoHttpOnlyCookie = "NO_HTTPONLY_COOKIE";

    /// <summary> NO_SAMESITE_COOKIE vulnerability </summary>
    public const string NoSameSiteCookie = "NO_SAMESITE_COOKIE";

    /// <summary> WEAK_RANDOMNESS vulnerability </summary>
    public const string WeakRandomness = "WEAK_RANDOMNESS";

    /// <summary> HARDCODED_SECRET vulnerability </summary>
    public const string HardcodedSecret = "HARDCODED_SECRET";

    /// <summary> XCONTENTTYPE_HEADER_MISSING vulnerability </summary>
    public const string XContentTypeHeaderMissing = "XCONTENTTYPE_HEADER_MISSING";

    /// <summary> TRUST_BOUNDARY_VIOLATION vulnerability </summary>
    public const string TrustBoundaryViolation = "TRUST_BOUNDARY_VIOLATION";

    /// <summary> HSTS_HEADER_MISSING vulnerability </summary>
    public const string HstsHeaderMissing = "HSTS_HEADER_MISSING";

    /// <summary> HEADER_INJECTION vulnerability </summary>
    public const string HeaderInjection = "HEADER_INJECTION";

    /// <summary> STACKTRACE_LEAK vulnerability </summary>
    public const string StackTraceLeak = "STACKTRACE_LEAK";

    /// <summary> NOSQL_MONGODB_INJECTION vulnerability </summary>
    public const string NoSqlMongoDbInjection = "NOSQL_MONGODB_INJECTION";

    /// <summary> XPATH_INJECTION vulnerability </summary>
    public const string XPathInjection = "XPATH_INJECTION";

    /// <summary> REFLECTION_INJECTION vulnerability </summary>
    public const string ReflectionInjection = "REFLECTION_INJECTION";

    /// <summary> INSECURE_AUTH_PROTOCOL vulnerability </summary>
    public const string InsecureAuthProtocol = "INSECURE_AUTH_PROTOCOL";

    /// <summary> XSS vulnerability </summary>
    public const string Xss = "XSS";

    // <summary> Directory listing leak vulnerability </summary>
    public const string DirectoryListingLeak = "DIRECTORY_LISTING_LEAK";

    /// <summary> Session timeout vulnerability </summary>
    public const string SessionTimeout = "SESSION_TIMEOUT";

    /// <summary> Email HTML Injection vulnerability </summary>
    public const string EmailHtmlInjection = "EMAIL_HTML_INJECTION";

    public static string GetName(VulnerabilityType vulnerability)
    {
        return vulnerability switch
        {
            VulnerabilityType.None => None,
            VulnerabilityType.WeakCipher => WeakCipher,
            VulnerabilityType.WeakHash => WeakHash,
            VulnerabilityType.SqlInjection => SqlInjection,
            VulnerabilityType.CommandInjection => CommandInjection,
            VulnerabilityType.PathTraversal => PathTraversal,
            VulnerabilityType.LdapInjection => LdapInjection,
            VulnerabilityType.Ssrf => Ssrf,
            VulnerabilityType.UnvalidatedRedirect => UnvalidatedRedirect,
            VulnerabilityType.InsecureCookie => InsecureCookie,
            VulnerabilityType.NoHttpOnlyCookie => NoHttpOnlyCookie,
            VulnerabilityType.NoSameSiteCookie => NoSameSiteCookie,
            VulnerabilityType.WeakRandomness => WeakRandomness,
            VulnerabilityType.HardcodedSecret => HardcodedSecret,
            VulnerabilityType.XContentTypeHeaderMissing => XContentTypeHeaderMissing,
            VulnerabilityType.TrustBoundaryViolation => TrustBoundaryViolation,
            VulnerabilityType.HstsHeaderMissing => HstsHeaderMissing,
            VulnerabilityType.HeaderInjection => HeaderInjection,
            VulnerabilityType.StackTraceLeak => StackTraceLeak,
            VulnerabilityType.NoSqlMongoDbInjection => NoSqlMongoDbInjection,
            VulnerabilityType.XPathInjection => XPathInjection,
            VulnerabilityType.ReflectionInjection => ReflectionInjection,
            VulnerabilityType.InsecureAuthProtocol => InsecureAuthProtocol,
            VulnerabilityType.Xss => Xss,
            VulnerabilityType.DirectoryListingLeak => DirectoryListingLeak,
            VulnerabilityType.SessionTimeout => SessionTimeout,
            VulnerabilityType.EmailHtmlInjection => EmailHtmlInjection,
            _ => throw new System.ArgumentException($"VulnerabilityName for VulnerabilityType.{vulnerability} missing.", "vulnerability"),
        };
    }
}
