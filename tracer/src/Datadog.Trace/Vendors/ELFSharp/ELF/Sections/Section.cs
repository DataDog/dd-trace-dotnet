//------------------------------------------------------------------------------
// <auto-generated />
// This file was automatically generated by the UpdateVendoredCode tool.
//------------------------------------------------------------------------------
#pragma warning disable CS0618, CS0649, CS1574, CS1580, CS1581, CS1584, CS1591, CS1573, CS8018, CS1587, SYSLIB0011, SYSLIB0023, SYSLIB0032
#if NETCOREAPP3_1_OR_GREATER
using System;
using System.IO;
using Datadog.Trace.Vendors.ELFSharp.Utilities;

namespace Datadog.Trace.Vendors.ELFSharp.ELF.Sections
{
    internal class Section<T> : ISection where T : struct
    {
        protected readonly SimpleEndianessAwareReader Reader;

        internal Section(SectionHeader header, SimpleEndianessAwareReader reader)
        {
            Header = header;
            Reader = reader;
        }

        public T RawFlags => Header.RawFlags.To<T>();

        public T LoadAddress => Header.LoadAddress.To<T>();

        public T Alignment => Header.Alignment.To<T>();

        public T EntrySize => Header.EntrySize.To<T>();

        public T Size => Header.Size.To<T>();

        public T Offset => Header.Offset.To<T>();

        internal SectionHeader Header { get; }

        public virtual byte[] GetContents()
        {
            if (Type == SectionType.NoBits) return Array.Empty<byte>();

            Reader.BaseStream.Seek((long)Header.Offset, SeekOrigin.Begin);
            return Reader.ReadBytes(Convert.ToInt32(Header.Size));
        }

        public string Name => Header.Name;

        public uint NameIndex => Header.NameIndex;

        public SectionType Type => Header.Type;

        public SectionFlags Flags => Header.Flags;

        public override string ToString()
        {
            return Header.ToString();
        }

        protected void SeekToSectionBeginning()
        {
            Reader.BaseStream.Seek((long)Header.Offset, SeekOrigin.Begin);
        }
    }
}
#endif