parameters:
  - name: 'artifact'
    type: 'string'
    default: 'build-windows-working-directory'

  - name: pipelineRunId
    type: string
    default: ''

steps:
- ${{if eq(parameters.pipelineRunId, '') }}:
  - task: DownloadPipelineArtifact@2
    displayName: Download working dir
    inputs:
      artifact: ${{ parameters.artifact }}
      patterns: "**/@(bin|obj|packages)/**"
      path: $(System.DefaultWorkingDirectory)

- ${{if ne(parameters.pipelineRunId, '') }}:
  - task: DownloadPipelineArtifact@2
    displayName: Download working dir from build pipeline
    inputs:
      source: specific
      project: $(consolidatedPipelineProject)
      pipeline: $(consolidatedPipelineDefinitionId)
      runVersion: specific
      runId: ${{ parameters.pipelineRunId }}
      preferTriggeringPipeline: true
      artifact: ${{ parameters.artifact }}
      patterns: "**/@(bin|obj|packages)/**"
      path: $(System.DefaultWorkingDirectory)
