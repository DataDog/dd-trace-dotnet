apiVersion: v1
kind: Pod
metadata:
  name: sample-app
  namespace: default
  labels:
    app: sample-dotnet-app
    admission.datadoghq.com/enabled: "true"
    admission.datadoghq.com/config.mode: "socket"
    tags.datadoghq.com/service: dotnet-service
spec:
  initContainers:
    - name: dotnet-init
      image: dockeranna123/test-auto-inst:latest  # put the library image here
      imagePullPolicy: Never
      command: ["sh", "copy-lib.sh", "/autoinstrumentation"]
      volumeMounts:
        - name: autoinstrumentation
          mountPath: /autoinstrumentation
  containers:
    - name: app
      image: mcr.microsoft.com/dotnet/samples:aspnetapp
      env:
        - name: DD_TRACE_DEBUG
          value: "true"
      ports:
        - containerPort: 8080
      volumeMounts:
        - name: autoinstrumentation
          mountPath: /autoinstrumentation
  volumes:
    - name: autoinstrumentation
      emptyDir: {}